<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>CSVã‹ã‚“ãŸã‚“å¤‰æ›ãƒ„ãƒ¼ãƒ«</title>
<style>
/* CSSã®å…¨å†…å®¹ã‚’ã“ã“ã«ç›´æ¥è¨˜è¿° */
:root {
Â  --primary: #0066cc;
Â  --primary-hover: #0052a3;
Â  --success: #28a745;
Â  --error: #dc3545;
Â  --warning: #ffc107;
Â  --bg-light: #f8f9fa;
Â  --border: #dee2e6;
Â  --text-dark: #212529;
Â  font-size: 18px;
}
* {
Â  margin: 0;
Â  padding: 0;
Â  box-sizing: border-box;
}
body {
Â  font-family: 'Meiryo', 'Yu Gothic', sans-serif;
Â  line-height: 1.8;
Â  background: var(--bg-light);
Â  padding: 20px;
Â  color: var(--text-dark);
}
.container {
Â  max-width: 900px;
Â  margin: 0 auto;
}
.header {
Â  background: linear-gradient(135deg, var(--primary), #0080ff);
Â  color: white;
Â  padding: 30px 25px;
Â  border-radius: 12px;
Â  margin-bottom: 30px;
Â  text-align: center;
Â  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}
.header h1 {
Â  font-size: 2em;
Â  margin-bottom: 10px;
}
.header p {
Â  font-size: 1.1em;
Â  opacity: 0.95;
}
.font-controls {
Â  background: white;
Â  padding: 15px;
Â  border-radius: 8px;
Â  margin-bottom: 20px;
Â  text-align: center;
Â  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.font-controls label {
Â  font-weight: bold;
Â  margin-right: 15px;
Â  font-size: 1.1em;
}
.font-btn {
Â  padding: 10px 18px;
Â  margin: 0 5px;
Â  border: 2px solid var(--border);
Â  background: white;
Â  border-radius: 6px;
Â  cursor: pointer;
Â  font-size: 1em;
Â  font-weight: bold;
Â  transition: all 0.3s;
}
.font-btn:hover {
Â  background: var(--primary);
Â  color: white;
Â  border-color: var(--primary);
}
.font-btn.active {
Â  background: var(--primary);
Â  color: white;
Â  border-color: var(--primary);
}
.section {
Â  background: white;
Â  padding: 30px;
Â  border-radius: 12px;
Â  margin-bottom: 25px;
Â  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
.section h2 {
Â  font-size: 1.6em;
Â  color: var(--primary);
Â  margin-bottom: 25px;
Â  padding-bottom: 12px;
Â  border-bottom: 3px solid var(--primary);
}
.help-box {
Â  background: #fff3cd;
Â  border-left: 4px solid #ffc107;
Â  padding: 15px;
Â  margin-bottom: 20px;
Â  border-radius: 6px;
}
.help-box h3 {
Â  font-size: 1.1em;
Â  color: #856404;
Â  margin-bottom: 8px;
}
.help-box ul {
Â  margin-left: 20px;
Â  color: #856404;
}
.help-box li {
Â  margin-bottom: 5px;
}
.info-box {
Â  background: #d1ecf1;
Â  border-left: 4px solid #0c5460;
Â  padding: 15px;
Â  margin-bottom: 20px;
Â  border-radius: 6px;
}
.info-box h3 {
Â  font-size: 1.1em;
Â  color: #0c5460;
Â  margin-bottom: 8px;
}
.info-box ul {
Â  margin-left: 20px;
Â  color: #0c5460;
Â  font-size: 0.95em;
}
.info-box li {
Â  margin-bottom: 3px;
}
.form-group {
Â  margin-bottom: 25px;
}
.form-label {
Â  display: block;
Â  font-size: 1.2em;
Â  font-weight: bold;
Â  margin-bottom: 12px;
Â  color: var(--text-dark);
}
.file-input-wrapper {
Â  position: relative;
Â  border: 3px dashed var(--border);
Â  border-radius: 12px;
Â  padding: 40px 20px;
Â  text-align: center;
Â  background: var(--bg-light);
Â  cursor: pointer;
Â  transition: all 0.3s;
}
.file-input-wrapper:hover {
Â  border-color: var(--primary);
Â  background: #e3f2fd;
}
.file-input-wrapper.has-file {
Â  border-color: var(--success);
Â  background: #d4edda;
}
.file-input-wrapper input[type="file"] {
Â  position: absolute;
Â  opacity: 0;
Â  width: 100%;
Â  height: 100%;
Â  top: 0;
Â  left: 0;
Â  cursor: pointer;
}
.file-icon {
Â  font-size: 3em;
Â  margin-bottom: 10px;
}
.file-text {
Â  font-size: 1.2em;
Â  font-weight: bold;
Â  color: var(--text-dark);
}
.file-subtext {
Â  font-size: 1em;
Â  color: #6c757d;
Â  margin-top: 8px;
}
.file-name {
Â  margin-top: 15px;
Â  font-size: 1.1em;
Â  color: var(--success);
Â  font-weight: bold;
}
select {
Â  width: 100%;
Â  padding: 16px;
Â  font-size: 1.2em;
Â  border: 2px solid var(--border);
Â  border-radius: 8px;
Â  background: white;
Â  cursor: pointer;
Â  transition: border-color 0.3s;
}
select:focus {
Â  outline: none;
Â  border-color: var(--primary);
Â  box-shadow: 0 0 0 3px rgba(0,102,204,0.1);
}
.btn-group {
Â  display: flex;
Â  gap: 15px;
}
.btn {
Â  width: 100%;
Â  padding: 18px;
Â  font-size: 1.3em;
Â  font-weight: bold;
Â  border: none;
Â  border-radius: 8px;
Â  cursor: pointer;
Â  transition: all 0.3s;
Â  min-height: 60px;
Â  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.btn-primary {
Â  background: var(--primary);
Â  color: white;
}
.btn-primary:hover:not(:disabled) {
Â  background: var(--primary-hover);
Â  transform: translateY(-2px);
Â  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}
.btn-primary:disabled {
Â  background: #ccc;
Â  cursor: not-allowed;
Â  opacity: 0.6;
}
.btn-secondary {
Â  background: #6c757d;
Â  color: white;
}
.btn-secondary:hover:not(:disabled) {
Â  background: #5a6268;
Â  transform: translateY(-2px);
Â  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}
.btn-secondary:disabled {
Â  background: #ccc;
Â  cursor: not-allowed;
Â  opacity: 0.6;
}
.message {
Â  display: none;
Â  padding: 20px;
Â  margin: 20px 0;
Â  border-radius: 8px;
Â  font-size: 1.2em;
Â  font-weight: bold;
Â  border-left: 5px solid;
}
.message.error {
Â  background: #f8d7da;
Â  border-color: var(--error);
Â  color: #721c24;
}
.message.success {
Â  background: #d4edda;
Â  border-color: var(--success);
Â  color: #155724;
}
.message.warning {
Â  background: #fff3cd;
Â  border-color: #ffc107;
Â  color: #856404;
}
.history-item {
Â  background: var(--bg-light);
Â  border-left: 5px solid var(--primary);
Â  padding: 18px 20px;
Â  margin-bottom: 15px;
Â  border-radius: 8px;
Â  transition: transform 0.2s;
}
.history-item:hover {
Â  transform: translateX(5px);
Â  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.history-date {
Â  font-size: 1.15em;
Â  font-weight: bold;
Â  color: var(--primary);
Â  margin-bottom: 8px;
}
.history-detail {
Â  font-size: 1.05em;
Â  color: var(--text-dark);
Â  margin-bottom: 5px;
}
.history-label {
Â  font-weight: bold;
Â  color: #6c757d;
}
.no-history {
Â  text-align: center;
Â  padding: 40px;
Â  color: #6c757d;
Â  font-size: 1.1em;
}
.loading-overlay {
Â  position: fixed;
Â  top: 0;
Â  left: 0;
Â  width: 100%;
Â  height: 100%;
Â  background: rgba(0,0,0,0.7);
Â  display: none;
Â  justify-content: center;
Â  align-items: center;
Â  z-index: 9999;
}
.loading-content {
Â  text-align: center;
Â  color: white;
}
.spinner {
Â  width: 60px;
Â  height: 60px;
Â  border: 6px solid rgba(255,255,255,0.3);
Â  border-top-color: white;
Â  border-radius: 50%;
Â  animation: spin 1s linear infinite;
Â  margin: 0 auto 20px;
}
@keyframes spin {
Â  to { transform: rotate(360deg); }
}
.loading-text {
Â  font-size: 1.5em;
Â  font-weight: bold;
}
*:focus {
Â  outline: 3px solid var(--primary);
Â  outline-offset: 2px;
}
.preview-section {
Â  margin-top: 25px;
Â  padding-top: 25px;
Â  border-top: 2px solid var(--border);
}
.preview-title {
Â  font-size: 1.3em;
Â  font-weight: bold;
Â  color: var(--text-dark);
Â  margin-bottom: 15px;
}
.table-preview {
Â  width: 100%;
Â  border-collapse: collapse;
Â  margin-top: 15px;
Â  font-size: 0.95em;
Â  overflow-x: auto;
Â  display: block;
}
.table-preview th, .table-preview td {
Â  border: 1px solid var(--border);
Â  padding: 10px;
Â  text-align: left;
Â  white-space: nowrap;
}
.table-preview th {
Â  background: #e9ecef;
Â  font-weight: bold;
Â  position: sticky;
Â  top: 0;
}
.ng-cell {
Â  background: #ffe5e5;
Â  font-weight: bold;
}
.ok-cell {
Â  background: #d4edda;
}
.preview-note {
Â  color: #6c757d;
Â  font-size: 0.95em;
Â  margin-top: 10px;
Â  font-style: italic;
}
.stats-box {
Â  background: #e7f3ff;
Â  border: 2px solid var(--primary);
Â  border-radius: 8px;
Â  padding: 15px;
Â  margin: 20px 0;
Â  display: flex;
Â  justify-content: space-around;
Â  flex-wrap: wrap;
Â  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}
.stat-item {
Â  text-align: center;
Â  padding: 10px;
Â  min-width: 120px;
}
.stat-number {
Â  font-size: 2em;
Â  font-weight: bold;
Â  color: var(--primary);
}
.stat-label {
Â  font-size: 1em;
Â  color: #6c757d;
Â  margin-top: 5px;
}
@media (max-width: 768px) {
Â  :root {
Â  Â  font-size: 16px;
Â  }
Â  .section {
Â  Â  padding: 20px;
Â  }
Â  .btn {
Â  Â  padding: 14px;
Â  }
Â  .font-btn {
Â  Â  margin: 5px 2px;
Â  }
Â  .table-preview {
Â  Â  font-size: 0.75em;
Â  }
Â  .header h1 {
Â  Â  font-size: 1.8em;
Â  }
Â  .stats-box {
Â  Â  flex-direction: column;
Â  }
Â  .stat-item {
Â  Â  border-bottom: 1px solid var(--border);
Â  Â  padding: 15px;
Â  }
Â  .stat-item:last-child {
Â  Â  border-bottom: none;
Â  }
}
</style>
</head>
<body>

<div class="container">
Â  <div class="header">
Â  Â  <h1>ğŸ“¦ CSVã‹ã‚“ãŸã‚“å¤‰æ›ãƒ„ãƒ¼ãƒ«</h1>
Â  Â  <p>åŸºå¹¹ã‚·ã‚¹ãƒ†ãƒ ã®CSVã‚’å®…é…ä¾¿ç”¨ã«å¤‰æ›ã—ã¾ã™</p>
Â  </div>

Â  <div class="font-controls">
Â  Â  <label>æ–‡å­—ã‚µã‚¤ã‚ºï¼š</label>
Â  Â  <button class="font-btn" data-size="16px">å°</button>
Â  Â  <button class="font-btn active" data-size="18px">æ¨™æº–</button>
Â  Â  <button class="font-btn" data-size="22px">å¤§</button>
Â  Â  <button class="font-btn" data-size="26px">ç‰¹å¤§</button>
Â  </div>

Â  <div class="section">
Â  Â  <h2>â“ ä½¿ã„æ–¹</h2>
Â  Â  <div class="help-box">
Â  Â  Â  <h3>ğŸ“ åŸºå¹¹ã‚·ã‚¹ãƒ†ãƒ CSVã«ã¤ã„ã¦</h3>
Â  Â  Â  <ul>
Â  Â  Â  Â  <li>å¿…é ˆã®åˆ—ï¼šã€Œ<strong>ä½æ‰€</strong>ã€ã¨ã„ã†åˆ—åãŒå¿…è¦ã§ã™</li>
Â  Â  Â  Â  <li>ä»»æ„ã®åˆ—ï¼šã€Œéƒµä¾¿ç•ªå·ã€ã€Œé›»è©±ã€ã€Œãƒ¡ãƒ¼ãƒ«ã€ãŒã‚ã‚Œã°ãƒã‚§ãƒƒã‚¯ã—ã¾ã™</li>
Â  Â  Â  Â  <li>ä¾‹ï¼šæ°å,ä½æ‰€,é›»è©±,ãƒ¡ãƒ¼ãƒ«,éƒµä¾¿ç•ªå· ãªã©ã®åˆ—ãŒã‚ã‚‹CSVãƒ•ã‚¡ã‚¤ãƒ«</li>
Â  Â  Â  </ul>
Â  Â  </div>
Â  </div>

Â  <div class="section">
Â  Â  <h2>ğŸ”„ CSVå¤‰æ›</h2>
Â  Â  <div id="message" class="message"></div>
Â  Â Â 
Â  Â  <div class="form-group">
Â  Â  Â  <label class="form-label">1ï¸âƒ£ CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</label>
Â  Â  Â  <div class="file-input-wrapper" id="fileWrapper">
Â  Â  Â  Â  <input type="file" id="csvFile" accept=".csv">
Â  Â  Â  Â  <div class="file-icon">ğŸ“„</div>
Â  Â  Â  Â  <div class="file-text">ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</div>
Â  Â  Â  Â  <div class="file-subtext">ã¾ãŸã¯ã€ã“ã“ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—</div>
Â  Â  Â  Â  <div class="file-name" id="fileName"></div>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="form-group">
Â  Â  Â  <label class="form-label">2ï¸âƒ£ å¤‰æ›å…ˆã®å®…é…ä¼šç¤¾ã‚’é¸æŠ</label>
Â  Â  Â  <select id="courierSelect">
Â  Â  Â  Â  <option value="Yamato">ãƒ¤ãƒãƒˆé‹è¼¸</option>
Â  Â  Â  Â  <option value="Sagawa">ä½å·æ€¥ä¾¿</option>
Â  Â  Â  Â  <option value="JapanPost">æ—¥æœ¬éƒµä¾¿</option>
Â  Â  Â  </select>
Â  Â  </div>

Â  Â  <div class="btn-group">
Â  Â  Â  <button id="convertBtn" class="btn btn-primary" disabled>
Â  Â  Â  Â  3ï¸âƒ£ å¤‰æ›ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
Â  Â  Â  </button>
Â  Â  </div>

Â  Â  <div id="previewSection" class="preview-section" style="display:none;">
Â  Â  Â  <div class="preview-title">ğŸ“Š å¤‰æ›çµæœãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</div>
Â  Â  Â  <div id="statsBox" class="stats-box"></div>
Â  Â  Â  <div id="previewContent"></div>
Â  Â  Â  <p class="preview-note">â€»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¯æœ€åˆã®5ä»¶ã§ã™</p>
Â  Â  </div>
Â  </div>

Â  <div class="section">
Â  Â  <h2>ğŸ“œ å¤‰æ›å±¥æ­´</h2>
Â  Â  <div id="historyList"></div>
Â  </div>
</div>

<div id="loading" class="loading-overlay">
Â  <div class="loading-content">
Â  Â  <div class="spinner"></div>
Â  Â  <div class="loading-text">å‡¦ç†ä¸­ã§ã™...</div>
Â  </div>
</div>

<script>
// ==================== è¨­å®š ====================
const ADDRESS_LIMIT = {Yamato:{a1:35,a2:35},Sagawa:{a1:40,a2:40},JapanPost:{a1:50,a2:50}};
const MAX_HISTORY = 50;
const COURIER_NAMES = {'Yamato':'ãƒ¤ãƒãƒˆé‹è¼¸','Sagawa':'ä½å·æ€¥ä¾¿','JapanPost':'æ—¥æœ¬éƒµä¾¿'};

// åŸºå¹¹ã‚·ã‚¹ãƒ†ãƒ ã®åˆ—åãƒ‘ã‚¿ãƒ¼ãƒ³
const COLUMN_PATTERNS = {
Â  postalCode: ['éƒµä¾¿ç•ªå·', 'éƒµä¾¿ç•ªå·ï¼ˆåŠè§’è‹±æ•°ï¼‰', 'postalCode', 'postal'],
Â  address: ['ä½æ‰€', 'ä½æ‰€ï¼ˆéƒ½é“åºœçœŒãƒ»å»ºç‰©åå«ã‚€ï¼‰', 'address', 'Address', 'æ‰€åœ¨åœ°'],
Â  recipientName: ['æ°å', 'ãŠå±Šã‘å…ˆã®å®›å', 'å®›å', 'name', 'recipientName'],
Â  phone: ['é›»è©±ç•ªå·', 'é›»è©±', 'TEL', 'phone'],
Â  email: ['ãƒ¡ãƒ¼ãƒ«', 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹', 'ãƒ¡ãƒ«ã‚¢ãƒ‰', 'email']
};

let historyData = JSON.parse(localStorage.getItem('csvHistory') || '[]');
let lastConvertedRows = [];
let lastFileName = '';

// ==================== å±¥æ­´ç®¡ç† ====================
function saveHistory(item){historyData.push(item);if(historyData.length>MAX_HISTORY) historyData.shift();localStorage.setItem('csvHistory',JSON.stringify(historyData));renderHistory();}
function renderHistory(){
Â  const div=document.getElementById('historyList'); div.innerHTML='';
Â  if(historyData.length===0){div.innerHTML='<div class="no-history">ã¾ã å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“</div>';return;}
Â  historyData.slice().reverse().forEach(h=>{
Â  Â  const el=document.createElement('div'); el.className='history-item';
Â  Â  el.innerHTML=`<div class="history-date">${new Date(h.date).toLocaleString('ja-JP')}</div>
Â  Â  Â  <div class="history-detail"><span class="history-label">å¤‰æ›å…ˆ:</span> ${COURIER_NAMES[h.courier]||h.courier}</div>
Â  Â  Â  <div class="history-detail"><span class="history-label">å¤‰æ›ä»¶æ•°:</span> ${h.count}ä»¶</div>
Â  Â  Â  <div class="history-detail"><span class="history-label">ã‚¨ãƒ©ãƒ¼ä»¶æ•°:</span> ${h.ngCount}ä»¶</div>
Â  Â  Â  <div class="history-detail"><span class="history-label">ãƒ•ã‚¡ã‚¤ãƒ«å:</span> ${h.fileName}</div>`;
Â  Â  div.appendChild(el);
Â  });
}

// ==================== CSVå‡¦ç† ====================
function parseCsv(text){
Â  const rows=[];let row=[],value='',inQuotes=false;
Â  let r=[],v='',iq=false;
Â  for(let i=0;i<text.length;i++){
Â  Â  const c=text[i],next=text[i+1];
Â  Â  if(c=='"'&&!iq){iq=true;continue;}
Â  Â  if(c=='"'&&iq){if(next=='"'){v+='"';i++;}else{iq=false;continue;}}
Â  Â  if(c==','&&!iq){r.push(v.trim());v='';continue;}
Â  Â  if((c=='\n'||c=='\r')&&!iq){if(c=='\r'&&next=='\n') i++;r.push(v.trim());if(r.some(c=>c!==''))
Â  Â  Â  rows.push(r);r=[];v='';continue;}v+=c;
Â  }
Â  if(v||r.length>0){r.push(v.trim());if(r.some(c=>c!=='')) rows.push(r);}
Â  return rows;
}
function escapeCsv(v){if(typeof v!=='string') v=String(v);return (v.includes(',')||v.includes('"')||v.includes('\n'))?`"${v.replace(/"/g,'""')}"`:v;}
function downloadCsv(rows,filename){const csv=rows.map(r=>r.map(escapeCsv).join(',')).join('\r\n');const bom=new Uint8Array([0xEF,0xBB,0xBF]);const blob=new Blob([bom,csv],{type:'text/csv;charset=utf-8'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=filename;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(a.href);}

// ==================== ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ ====================
function findColumnIndex(header,patterns){for(let i=0;i<header.length;i++){const col=header[i].trim();for(const p of patterns){if(col===p||col.includes(p)){return i;}}}return -1;}
function findColumns(header){return{
Â  postalCode:findColumnIndex(header,COLUMN_PATTERNS.postalCode),
Â  address:findColumnIndex(header,COLUMN_PATTERNS.address),
Â  recipientName:findColumnIndex(header,COLUMN_PATTERNS.recipientName),
Â  phone:findColumnIndex(header,COLUMN_PATTERNS.phone),
Â  email:findColumnIndex(header,COLUMN_PATTERNS.email)
};}
function checkPostalCode(postal){if(!postal)return'NG';const p=postal.replace(/[-âˆ’]/g,'');return/^\d{7}$/.test(p)?'OK':'NG';}
function checkPhone(p){if(!p)return'OK';const x=p.replace(/[-âˆ’\s()ï¼ˆï¼‰]/g,'');return(/^\d{9,11}$/.test(x))?'OK':'NG';}
function checkEmail(e){if(!e)return'OK';return(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))?'OK':'NG';}

// ==================== ä½æ‰€åˆ†å‰² ====================
function splitAddress(address,courier){if(!address)return['',''];const lim=ADDRESS_LIMIT[courier]||{a1:35,a2:35};if(address.length<=lim.a1)return[address,''];const sub=address.substring(0,lim.a1);const matches=[...sub.matchAll(/[\s\-âˆ’ã€€ãƒ¼ã€ã€‚]/g)];if(matches.length>0){const last=matches[matches.length-1];const splitPoint=last.index+1;if(splitPoint>lim.a1/2){return[address.substring(0,splitPoint).trim(),address.substring(splitPoint).trim()];}}return[address.substring(0,lim.a1).trim(),address.substring(lim.a1).trim()];}

// ==================== ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ ====================
function renderPreview(rows,courier,columns){
Â  const previewDiv=document.getElementById('previewContent'); const previewSection=document.getElementById('previewSection');
Â  previewDiv.innerHTML=''; previewSection.style.display='block';
Â  const table=document.createElement('table');table.className='table-preview';
Â  const thead=document.createElement('thead');const trh=document.createElement('tr');
Â  ['ãƒã‚§ãƒƒã‚¯çµæœ',...rows[0]].forEach(h=>{const th=document.createElement('th');th.textContent=h;trh.appendChild(th);});
Â  thead.appendChild(trh);table.appendChild(thead);
Â  const tbody=document.createElement('tbody'); let totalNg=0; const maxRows=Math.min(rows.length-1,5);
Â  for(let i=1;i<=maxRows;i++){
Â  Â  const row=rows[i];const tr=document.createElement('tr'); let rowNg=false;
Â  Â  const tdStatus=document.createElement('td');
Â  Â  rows[0].forEach((h,j)=>{const td=document.createElement('td');td.textContent=row[j];tr.appendChild(td);});
Â  Â  const postalStatus=checkPostalCode(row[columns.postalCode]);
Â  Â  const phoneStatus=checkPhone(row[columns.phone]);
Â  Â  const emailStatus=checkEmail(row[columns.email]);
Â  Â  const [a1,a2]=splitAddress(row[columns.address]||'',courier);
Â  Â  if(postalStatus==='NG'||phoneStatus==='NG'||emailStatus==='NG'||a2!==''){rowNg=true;totalNg++;}
Â  Â  tdStatus.textContent=rowNg?'âš ï¸NG':'âœ…OK';tdStatus.className=rowNg?'ng-cell':'ok-cell';
Â  Â  tr.prepend(tdStatus);
Â  Â  tbody.appendChild(tr);
Â  }
Â  table.appendChild(tbody);previewDiv.appendChild(table);
Â  return totalNg;
}
</script>
</body>
</html>